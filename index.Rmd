---
title: "RStudio Datasets"
author: "Nicholas Moore"
date: "2022-07-29 - Present"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## {.tabset .tabset-fade} 

**Background:** Creating a variety of storytelling plots with RStudio's built-in datasets. 

### Iris  



**Loading Data / Basic Plotting Tutorial**
```{r message=FALSE, warning=FALSE}
library(ggplot2) #qplot (basic scatterplot) 
library(datasets)
library(tidyverse)
library(ggthemes)
library(tinytex)
library(prettydoc) 
windowsFonts(Times = windowsFont("Times New Roman"))
library(ggthemes)
```


?datasets
library(help = "datasets")
?iris

iris
head(iris)

#basic scatterplot
```{r message=FALSE, warning=FALSE}
qplot(Petal.Width, Petal.Length, data=iris)
```

#basic scatterplot w/ species colored
```{r message=FALSE, warning=FALSE}
qplot(Petal.Width, Petal.Length, color=Species, data=iris)
```

#same thing as above, but strictly ggplot2
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species))+
      geom_point()
```

#size matches sepal length. jitter separates dots slightly for viewing. alpha makes dots more transparent
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species, size=Sepal.Length))+
  geom_jitter(alpha=0.5)
```

#size matches sepal length. jitter separates dots slightly for viewing. alpha makes dots more transparent. geom_smooth makes regression line with std. error
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species, size=Sepal.Length))+
  geom_point(size=2)+
  geom_smooth(method=lm)+
  theme(legend.position = "right")
```

#histogram
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Length, fill=Species))+
  geom_histogram()+
  theme(legend.position = "right")
```

#histogram w/ indiv. plots for species w/ facet_grid
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Length, fill=Species))+
  geom_histogram()+
  facet_grid(Species ~ .)
  theme(legend.position = "none")
```
  
#histogram w/ indiv. plots for species w/ facet_grid (geom_density is cleaner, less blocky)
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Length, fill=Species))+
  geom_density(alpha=0.5)+
  facet_grid(Species ~ .)
theme(legend.position = "none")
```

#facet_grid with previous scatterplots
```{r echo=TRUE, message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species, size=Sepal.Length))+
  geom_point(size=2)+
  geom_smooth(method=lm)+
  facet_grid(Species ~ .)
  theme(legend.position = "right")
```
  
#Key Figures

windowsFonts(Times = windowsFont("Times New Roman"))
library(ggthemes)

```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Sepal.Width, Sepal.Length, color=Species, size=Sepal.Length))+
  geom_point(size=2)+
  geom_smooth(method=lm)+
  theme_fivethirtyeight(base_size = 12, base_family = "Times")+
  labs(title="Correlation Between Sepal Width and Sepal Length of Iris Species",
       caption="Data were collected by Anderson, Edgar (1935).")+
  labs(x = "Sepal Width")+
  labs(y = "Sepal Length")+
  theme(legend.position = "right")
```

#SEPAL WIDTH VS. SEPAL LENGTH w/out theme
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Sepal.Width, Sepal.Length, color=Species, size=Sepal.Length))+
  geom_point(size=2)+
  geom_smooth(method=lm)+
  labs(title="Correlation Between Sepal Width and Sepal Length of Iris Species",
       caption="Data were collected by Anderson, Edgar (1935).")+
  labs(x = "Sepal Width (cm)")+
  labs(y = "Sepal Length (cm)")+
  xlim(2.0, 4.5)+
  ylim(0.0, 10.0)+
  theme(legend.position = "bottom")
```

#SEPAL WIDTH VS. SEPAL LENGTH w/ theme
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Sepal.Width, Sepal.Length, color=Species, size=Sepal.Length))+
  geom_point(size=2)+ 
  geom_smooth(method=lm)+
  theme_fivethirtyeight(base_size = 12, base_family = "Times")+
  labs(title="Correlation Between Sepal Width and Sepal Length of Iris Species",
       caption="Data were collected by Anderson, Edgar (1935).")+
  theme(axis.title = element_text()) + ylab('Sepal Length (cm)') + xlab('Sepal Width (cm)')+
  xlim(2.0, 4.5)+
  ylim(0.0, 10.0)+
  theme(legend.position = "bottom")
```



#PETAL WIDTH VS. PETAL LENGTH w/out theme
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species, size=Petal.Length))+
  geom_point(size=2)+
  geom_smooth(method=lm)+
  labs(title="Correlation Between Petal Width and Petal Length of Iris Species",
       caption="Data were collected by Anderson, Edgar (1935).")+
  labs(x = "Petal Width (cm)")+
  labs(y = "Petal Length (cm)")+
  xlim(0.0, 3.0)+
  ylim(0.0, 8.0)+
  theme(legend.position = "bottom")
```

#PETAL WIDTH VS. PETAL LENGTH w/ theme & facet
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species, size=Petal.Length))+
  geom_point(size=2)+
  geom_smooth(method=lm)+
  labs(title="Correlation Between Petal Width and Petal Length of Iris Species",
       caption="Data were collected by Anderson, Edgar (1935).")+
  labs(x = "Petal Width (cm)")+
  labs(y = "Petal Length (cm)")+
  xlim(0.0, 3.0)+
  ylim(0.0, 8.0)+
  facet_grid(Species ~ .)+
  theme(legend.position = "right")
```

#PETAL WIDTH VS. PETAL LENGTH w/ theme
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species, size=Petal.Length))+
  geom_point(size=2)+ 
  geom_smooth(method=lm)+
  theme_fivethirtyeight(base_size = 12, base_family = "Times")+
  labs(title="Correlation Between Petal Width and Petal Length of Iris Species",
       caption="Data were collected by Anderson, Edgar (1935).")+
  theme(axis.title = element_text()) + ylab('Petal Length (cm)') + xlab('Petal Width (cm)')+
  xlim(0.0, 3.0)+
  ylim(0.0, 8.0)+
  theme(legend.position = "bottom")
```


#PETAL WIDTH VS. PETAL LENGTH w/ theme & facet
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(Petal.Width, Petal.Length, color=Species, size=Petal.Length))+
  geom_point(size=2)+ 
  geom_smooth(method=lm)+
  theme_fivethirtyeight(base_size = 12, base_family = "Times")+
  labs(title="Correlation Between Petal Width and Petal Length of Iris Species",
       caption="Data were collected by Anderson, Edgar (1935).")+
  theme(axis.title = element_text()) + ylab('Petal Length (cm)') + xlab('Petal Width (cm)')+
  xlim(0.0, 3.0)+
  ylim(0.0, 8.0)+
  facet_grid(Species ~ .)+
  theme(legend.position = "right")
```


#Boxplot NO ggplot2 Sepal Length
```{r message=FALSE, warning=FALSE}
boxplot(Sepal.Length~Species,
        data=iris, 
        main='Sepal Length by Species',
        sub='Data were collected by Anderson, Edgar (1935).',
        xlab='Species',
        ylab='Sepal Length (cm)',
        col='darkgreen',
        border='black')
```


#Boxplot w/ ggplot2 Sepal Length
```{r message=FALSE, warning=FALSE}
ggplot(iris, aes(x=Species, y=Sepal.Length, fill=Species)) + 
  geom_boxplot(width=0.5,lwd=1)+
  labs(title="Sepal Length by Species", x = "Species", y = "Sepal Length (cm)",  
       caption="Data were collected by Anderson, Edgar (1935).")
```


#Boxplot w/ ggplot2 Sepal Width
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(iris, aes(x=Species, y=Sepal.Width, fill=Species)) + 
  geom_boxplot(width=0.5,lwd=1)+
  labs(title="Sepal Length by Species", x = "Species", y = "Sepal Width (cm)",  
       caption="Data were collected by Anderson, Edgar (1935).")

```

#Boxplot w/ ggplot2 Petal Length
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(iris, aes(x=Species, y=Petal.Length, fill=Species)) + 
  geom_boxplot(width=0.5,lwd=1)+
  labs(title="Sepal Length by Species", x = "Species", y = "Petal Length (cm)",  
       caption="Data were collected by Anderson, Edgar (1935).")
```


#Boxplot w/ ggplot2 Petal Width
```{r message=FALSE, paged.print=FALSE}
ggplot(iris, aes(x=Species, y=Petal.Width, fill=Species)) + 
  geom_boxplot(width=0.5,lwd=1)+
  labs(title="Sepal Length by Species", x = "Species", y = "Petal Width (cm)",  
       caption="Data were collected by Anderson, Edgar (1935).")
```






























### AirPassengers 

**Loading Data / Basic Plotting Tutorial**
```{r message=FALSE, warning=FALSE}
library(ggplot2) #qplot (basic scatterplot) 
library(ggthemes)
library(tidyverse)
library(datasets)
library(ggfortify)
library(forecast) #for autoplot with geom_smooth linear regression
library(tseries) #for autoplot with geom_smooth linear regression
```

?datasets
library(help = "datasets")
?AirPassengers

AirPassengers
head(AirPassengers)

#this dataset does not have column names, but that won't stop us

class(AirPassengers) #ts is the output = this means the data is a time series 
start(AirPassengers) #shows first year 
end(AirPassengers) #shows last year


```{r message=FALSE, warning=FALSE}
plot(AirPassengers, xlab="Year", ylab="Air Passengers (1,000s)", main="Time Series of Air Passengers", 
     sub="The classic Box & Jenkins airline data. Monthly totals of international airline passengers, 1949 to 1960.")
```


```{r message=FALSE, warning=FALSE}
boxplot(AirPassengers~cycle(AirPassengers),xlab="Date", ylab = "Air Passengers (1,000s)" ,main ="Monthly Air Passengers Boxplot from 1949 to 1961")
```


```{r message=FALSE, warning=FALSE}
autoplot(AirPassengers) + 
  geom_smooth(method="lm")+ 
  labs(x ="Date", y = "Air Passengers (1,000s)", title="Air Passengers from 1949 to 1961") 
```
  
ARIMA is an acronym for “autoregressive integrated moving average.” It's a model used in statistics and econometrics to measure events that happen over a period of time.

```{r message=FALSE, warning=FALSE}
arimaAirPassengers <- auto.arima(AirPassengers)
arimaAirPassengers
```

If the residuals plot is around 0 w/ no movement, then ARIMA model is a good fit
```{r message=FALSE, warning=FALSE}
ggtsdiag(arimaAirPassengers)
```

95% confidence looking 48 months into the future
```{r message=FALSE, warning=FALSE}
forecastAirPassengers <- forecast(arimaAirPassengers, level = c(95), h = 48)
autoplot(forecastAirPassengers)
```




























### BJsales

**Loading Data / Basic Plotting Tutorial**
```{r message=FALSE, warning=FALSE}

library(ggplot2) #qplot (basic scatterplot) 
library(ggthemes)
library(tidyverse)
library(datasets)
library(ggfortify)
library(tseries) #for autoplot with geom_smooth linear regression
library(forecast) #for autoplot with geom_smooth linear regression
```

?datasets
library(help = "datasets")
?BJsales

BJsales
head(BJsales)

class(BJsales) #ts is the output = this means the data is a time series 
start(BJsales) #shows first year 
end(BJsales) #shows last year

```{r message=FALSE, warning=FALSE}
plot(BJsales, xlab="Time", ylab="Sales", main="Sales ", col.main="SteelBlue",
     sub="The data are given in Box & Jenkins (1976). Obtained from the Time Series Data Library at https://robjhyndman.com/TSDL/")
```


boxplot(BJsales~cycle(BJsales),xlab="Date (unknown scale)", ylab = "Sales (unknown scale)" ,main ="Sales Over Time")


```{r message=FALSE, warning=FALSE}
autoplot(BJsales) + 
  geom_smooth(method="lm")+ 
  labs(x ="Date (unknown scale)", y = "Sales (unknown scale)", title="Sales Over Time") 
```

#ARIMA is an acronym for “autoregressive integrated moving average.” It's a model used in statistics and econometrics to measure events that happen over a period of time.
```{r message=FALSE, warning=FALSE}
arimaBJsales <- auto.arima(BJsales)
arimaBJsales
```


#if the residuals plot is around - w/ no movement, then ARIMA model is a good fit
```{r message=FALSE, warning=FALSE}
ggtsdiag(arimaBJsales)
```


#95% confidence looking 10 months into the future
```{r message=FALSE, warning=FALSE}
forecastBJsales <- forecast(arimaBJsales, level = c(95), h = 10)
autoplot(forecastBJsales)
```



```{r message=FALSE, warning=FALSE}
forecastedJsales <- forecast(arimaBJsales, 10)
plot(forecastedJsales, main="Forecast of Sales Over Time", col.main="SteelBlue", ylab = "Sales (unknown scale)", xlab="Date (unknown scale)")
```





























### BOD  



**Loading Data / Basic Plotting Tutorial**
```{r message=FALSE, warning=FALSE}
library(ggplot2) #qplot (basic scatterplot) 
library(ggthemes)
library(tidyverse)
library(datasets)
library(ggfortify)
```

?datasets
library(help = "datasets")
?BOD

BOD
head(BOD)

class(BOD) #data frame

#same thing as basic ggplot
```{r message=FALSE, warning=FALSE}
qplot(Time, demand, data=BOD)
```

```{r message=FALSE, warning=FALSE}
ggplot(BOD, aes(Time, demand))+
  geom_point()
```


```{r message=FALSE, warning=FALSE}
ggplot(BOD, aes(Time, demand))+
  geom_line()+
  expand_limits(y=0, x=0)+
  labs(title="Biochemical Oxygen Demand Versus Time", x = "Time (days)", y = "Biochemical Oxygen Demand (mg/l)",  
       caption="Bates, D.M. and Watts, D.G. (1988), Nonlinear Regression Analysis and Its Applications, Wiley, Appendix A1.4.")+
  theme(plot.title = element_text(color = "SteelBlue"))

```































### CO2



**Loading Data / Basic Plotting Tutorial**
```{r message=FALSE, warning=FALSE}
library(ggplot2) #qplot (basic scatterplot) 
library(ggthemes)
library(tidyverse)
library(datasets)
library(ggfortify)
```


?datasets
library(help = "datasets")
?CO2

CO2
head(CO2)

class(CO2) #data frame

same thing as basic ggplot
```{r}
qplot(uptake, conc, data=CO2, fill=Type)
```




```{r}
ggplot(CO2, aes(x=Treatment, y=uptake)) + 
  geom_boxplot()
```

```{r}
t.test(CO2$uptake ~ CO2$Treatment)
```



```{r}
ggplot(CO2, aes(x=Type, y=uptake)) + 
  geom_boxplot()
```

```{r}
t.test(CO2$uptake ~ CO2$Type)
```


set the plotting area into a 1*2 array
```{r}
par(mfrow = c(1,2)) 
boxplot(CO2$uptake ~ CO2$Treatment)
boxplot(CO2$uptake ~ CO2$Type)
```


set the plotting area into a 1*1 array
```{r}
par(mfrow = c(1,1))
boxplot(CO2$uptake ~ CO2$Type + CO2$Treatment)
```


```{r}
par(mfrow = c(1,1))
boxplot(subset(CO2$uptake, CO2$conc == 95), 
        subset(CO2$uptake, CO2$conc == 175),
        subset(CO2$uptake, CO2$conc == 250),
        subset(CO2$uptake, CO2$conc == 350),
        subset(CO2$uptake, CO2$conc == 500),
        subset(CO2$uptake, CO2$conc == 675),
        subset(CO2$uptake, CO2$conc == 1000), 
        names = c("95", "175", "250", "350", "500", "675", "1000"))
```



```{r}
par(mfrow = c(2,2))
plot(uptake ~ conc, data = subset(CO2,Type == "Quebec" & Treatment == "chilled"), 
     main="Chilled Quebec", xlab = "Concentration (ML/L)", ylab = "Carbon Dioxide Uptake (μmol/m2s)" )
plot(uptake ~ conc, data = subset(CO2,Type == "Mississippi" & Treatment == "chilled"), 
     main="Chilled Mississippi", xlab = "Concentration (ML/L)", ylab = "Carbon Dioxide Uptake (μmol/m2s)")
plot(uptake ~ conc, data = subset(CO2,Type == "Quebec" & Treatment == "nonchilled"),
     main="Nonchilled Quebec", xlab = "Concentration (ML/L)", ylab = "Carbon Dioxide Uptake (μmol/m2s)")
plot(uptake ~ conc, data = subset(CO2,Type == "Mississippi" & Treatment == "nonchilled"), 
     main="Nonchilled Mississippi", xlab = "Concentration (ML/L)", ylab = "Carbon Dioxide Uptake (μmol/m2s)")
```



```{r}
ggplot(CO2, aes(conc, uptake, color=Treatment, shape=Type)) + 
  geom_point()+
  expand_limits(y=0, x=0)+
  labs(title="CO2 Uptake of Plants from Mississippi and Quebec", x = "Concentration (ML/L)", y = "Carbon Dioxide Uptake (μmol/m2s)",  
       caption="The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance of the grass species Echinochloa crus-galli.")
```


```{r}
ggplot(CO2, aes(conc, uptake, color=Plant, type=Treatment)) + 
  geom_line()+
  geom_point()+
  expand_limits(y=0, x=0)+
  labs(title="CO2 Uptake of Plants from Mississippi and Quebec", x = "Concentration (ML/L)", y = "Carbon Dioxide Uptake (μmol/m2s)",  
       caption="The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance of the grass species Echinochloa crus-galli.")
```

